function admin2020newfolder(){foldername=jQuery("#foldername").val(),foldertag=jQuery("#admin2020_foldertag input[name=color_tag]:checked").val(),foldername.length>0&&jQuery.ajax({url:admin2020_admin_folder_ajax.ajax_url,type:"post",data:{action:"admin2020_create_folder",security:admin2020_admin_folder_ajax.security,title:foldername,foldertag:foldertag,screen:admin2020_admin_folder_ajax.screen},success:function(e){jQuery("#admin2020folderswrap").prepend(e),UIkit.notification("Folder Created!","success")}})}function admin2020deletefolder(e){jQuery.ajax({url:admin2020_admin_folder_ajax.ajax_url,type:"post",data:{action:"admin2020_delete_folder",security:admin2020_admin_folder_ajax.security,folderid:e,screen:admin2020_admin_folder_ajax.screen},success:function(a){a&&(data=JSON.parse(a),data.error?(UIkit.notification(data.error,"danger"),UIkit.modal(jQuery("#admin2020_edit_folder")).hide()):(toremove=document.getElementById("folder"+e),jQuery(toremove).remove(),UIkit.notification(data.message,"success"),UIkit.modal(jQuery("#admin2020_edit_folder")).hide()))}})}function admin2020renamefolder(e){newfoldername=jQuery("#admin2020_edit_folder").find("#foldername_update").val(),foldertag=jQuery("#admin2020_folder_tag_update input[name=color_tag]:checked").val(),newfoldername.length>0&&jQuery.ajax({url:admin2020_admin_folder_ajax.ajax_url,type:"post",data:{action:"admin2020_rename_folder",security:admin2020_admin_folder_ajax.security,title:newfoldername,folderid:e,foldertag:foldertag,screen:admin2020_admin_folder_ajax.screen},success:function(a){a&&(data=JSON.parse(a),data.error?(UIkit.notification(data.error,"danger"),UIkit.modal(jQuery("#admin2020_edit_folder")).hide()):(toremove=document.getElementById("folder"+e),jQuery(toremove).replaceWith(data.html),UIkit.notification(data.message,"success"),UIkit.modal(jQuery("#admin2020_edit_folder")).hide()))}})}function move_folder_to_folder(e,a){var t=e,d=a;jQuery.ajax({url:admin2020_admin_folder_ajax.ajax_url,type:"post",data:{action:"admin2020_move_folder_into_folder",security:admin2020_admin_folder_ajax.security,destination_id:e,origin_id:a,page_id:admin2020_admin_folder_ajax.screen,screen:admin2020_admin_folder_ajax.screen},success:function(e){e&&(data=JSON.parse(e),data.error?UIkit.notification(data.error,"danger"):(UIkit.notification(data.message,"primary"),string="#folder"+t,string_remove="#folder"+d,jQuery(string).hasClass("admin2020_top_level_folder")?toplevel=string:toplevel=jQuery(string).closest("admin2020_top_level_folder").attr("attr"),open=null,jQuery(toplevel).hasClass("sub_open")&&(open=!0),destination=document.getElementById("folder"+t),toremove=document.getElementById("folder"+d),"false"==t?jQuery("#admin2020folderswrap").prepend(data.html):jQuery(destination).replaceWith(data.html),jQuery(toremove).remove(),open&&jQuery(toplevel).addClass("sub_open")))}})}function movetofolder(e,a){var t=admin2020_admin_folder_ajax.page_now;jQuery.ajax({url:admin2020_admin_folder_ajax.ajax_url,type:"post",data:{action:"admin2020_move_to_folder",security:admin2020_admin_folder_ajax.security,theids:a,folderid:e,page_id:t,screen:admin2020_admin_folder_ajax.screen},success:function(t){t&&(data=JSON.parse(t),UIkit.notification(data.message,"success"),rebuild_folder_stack("",data.html),add_folder_ids(e,a))}})}function add_folder_ids(e,a){jQuery.each(a,function(a,t){string="#file_"+t,jQuery(string).attr("a2020_folder",e),jQuery('[data-id="'+t+'"]').length>0&&(attachment=jQuery('[data-id="'+t+'"]'),classList=jQuery(attachment).attr("class").split(/\s+/),jQuery.each(classList,function(e,a){a.includes("folder")&&jQuery(attachment).removeClass(a)}),jQuery(attachment).addClass("folder"+e))}),options=[],options.target=".attachments",UIkit.filter(".a2020_legacy_filter",options)}function admin2020_set_folder_query(e){wp.media.frame.content.get().collection.props.set({folder_id:e})}function rebuild_folder_stack(e,a){jQuery(".admin2020folder.sub_open").each(function(){the_id=jQuery(this).attr("folder-id"),theids.push(the_id)}),""!=e?jQuery("#folder"+e).replaceWith(a):jQuery("#admin2020folderswrap").html(a),jQuery.each(theids,function(e,a){string="#folder"+a,jQuery(string).addClass("sub_open")})}function update_folders(){var e=admin2020_admin_folder_ajax.page_now;jQuery.ajax({url:admin2020_admin_folder_ajax.ajax_url,type:"post",data:{action:"admin2020_refresh_all_folders",security:admin2020_admin_folder_ajax.security,page_id:e},success:function(e){theids=[],jQuery(".admin2020folder.sub_open").each(function(){the_id=jQuery(this).attr("folder-id"),theids.push(the_id)}),jQuery("#admin2020folderswrap").html(e),jQuery.each(theids,function(e,a){string="#folder"+a,jQuery(string).addClass("sub_open")})}})}function admin2020_edit_folder(e){folderstring="#folder"+e,the_folder=jQuery(folderstring),folder_name=jQuery(folderstring).find(".folder_title").html(),color_tag=jQuery(folderstring).find(".folder_tag").attr("value"),jQuery("#admin2020_edit_folder").find("#foldername_update").val(folder_name),jQuery("#admin2020_folder_tag_update input").each(function(){value=jQuery(this).val(),value==color_tag&&jQuery(this).prop("checked",!0)}),UIkit.modal(jQuery("#admin2020_edit_folder")).show(),jQuery("#delete_the_folder").off("click").on("click",function(){admin2020deletefolder(e)}),jQuery("#update_the_folder").off("click").on("click",function(){admin2020renamefolder(e)})}function admin2020wp_mediadrag(e){jQuery(".uploader-window").addClass("force_hide"),jQuery(e.target).hasClass("legacy_attachment")?e.dataTransfer.setData("text",jQuery(e.target).attr("data-id")):(theid=jQuery(e.target).closest(".legacy_attachment").attr("data-id"),e.dataTransfer.setData("text",theid)),console.log(jQuery(e.target).attr("data-id")),thefiles=jQuery(".legacy_attachment.selected").length,thefiles<1?thefiles="1 file":thefiles+=" files";var a=document.createElement("div");a.id="admin2020dragHandle",a.innerHTML=thefiles,a.style.position="absolute",a.style.top="-1000px",document.body.appendChild(a),e.dataTransfer.setDragImage(a,0,0)}function admin2020mediadrag(e){jQuery(e.target).hasClass("attachment_wrap")?e.dataTransfer.setData("text",e.target.id):(theid=jQuery(e.target).closest(".attachment_wrap").attr("id"),e.dataTransfer.setData("text",theid)),thefiles=jQuery("#a2020_media_items .a2020_attachment.a2020_selected").length,thefiles<1?thefiles="1 file":thefiles+=" files";var a=document.createElement("div");a.id="admin2020dragHandle",a.innerHTML=thefiles,a.style.position="absolute",a.style.top="-1000px",document.body.appendChild(a),e.dataTransfer.setDragImage(a,0,0)}function admin2020mediaAllowDrop(e){e.preventDefault(),drop=e.target,jQuery(drop).hasClass("admin2020folder")?jQuery(drop).addClass("folderdrag"):jQuery(drop).closest(".admin2020folder").addClass("folderdrag")}function admin2020mediaDropOut(e){e.preventDefault(),drop=e.target,jQuery(drop).hasClass("admin2020folder")?jQuery(drop).removeClass("folderdrag"):jQuery(drop).closest(".admin2020folder").removeClass("folderdrag")}function admin2020postdrop(e){e.stopImmediatePropagation(),e.preventDefault(),drop=e.target,console.log(e),folder_check=e.dataTransfer.getData("text"),origin_folder_id=null,folder_check&&folder_check.includes("folder")&&(folder_chunks=folder_check.split("folder"),origin_folder_id=folder_chunks[1]),jQuery(drop).hasClass("admin2020folder")?(jQuery(drop).removeClass("folderdrag"),folder=e.target):(jQuery(drop).closest(".admin2020folder").removeClass("folderdrag"),folder=jQuery(drop).closest(".admin2020folder")),jQuery(folder).hasClass("admin2020allFolders")?folderid="":folderid=jQuery(folder).attr("folder-id"),origin_folder_id?origin_folder_id!=folderid&&move_folder_to_folder(folderid,origin_folder_id):(theids=[],amount=jQuery("#a2020_media_items .a2020_attachment.a2020_selected").length,legacy_wp=jQuery(".legacy_attachment.selected").length,amount>0?jQuery("#a2020_media_items .a2020_attachment.a2020_selected").each(function(e,a){theid=jQuery(a).parent().attr("attachment_id"),theids.push(theid)}):legacy_wp>0?jQuery(".legacy_attachment.selected").each(function(e,a){theid=jQuery(a).attr("data-id"),theids.push(theid)}):(data=e.dataTransfer.getData("text"),lonedragger=document.getElementById(data),theid=jQuery(lonedragger).attr("attachment_id"),theid||(theid=data),console.log(theid),theids.push(theid)),movetofolder(folderid,theids))}function admin2020folderdrag(e){if(jQuery(".uploader-window").addClass("force_hide"),jQuery(e.target).hasClass("admin2020folder"))var a=e.target.id;else a=jQuery(e.target).closest(".admin2020folder").attr("id");e.dataTransfer.setData("text",a)}jQuery(document).ready(function(e){e(document).on("dragstart",".attachment_wrap",function(e){admin2020mediadrag(e.originalEvent)}),e(document).on("dragstart",".attachment",function(e){admin2020wp_mediadrag(e.originalEvent)})});